<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bucket List</title>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; padding: 20px; background-color: #f0f2f5; font-family: 'Gowun Dodum', sans-serif; color: #333; }
        .container { max-width: 600px; margin: 0 auto; padding-bottom: 50px; }
        .header { text-align: center; margin-bottom: 30px; position: relative; padding-top: 10px; }
        .home-btn { position: absolute; left: 0; top: 0; text-decoration: none; font-size: 24px; background: white; width: 40px; height: 40px; line-height: 40px; border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { margin: 0; font-size: 24px; color: #333; }
        p { color: #777; font-size: 14px; margin-top: 5px; }
        .progress-container { background-color: #e0e0e0; border-radius: 25px; margin-bottom: 40px; height: 30px; position: relative; overflow: hidden; }
        .progress-bar { background: linear-gradient(90deg, #ff9a9e 0%, #fad0c4 50%, #fbc2eb 100%); height: 100%; width: 0%; border-radius: 25px; transition: width 1s ease-in-out; display: flex; align-items: center; padding-left: 15px; color: white; font-size: 13px; font-weight: bold; white-space: nowrap; }
        .bucket-list { list-style: none; padding: 0; }
        .bucket-item { background: white; margin-bottom: 15px; padding: 15px 20px; border-radius: 15px; display: flex; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.03); transition: all 0.3s ease; cursor: pointer; }
        .bucket-item:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,0.08); }
        .check-icon { width: 26px; height: 26px; border: 2px solid #ddd; border-radius: 50%; margin-right: 15px; display: flex; align-items: center; justify-content: center; color: transparent; font-size: 16px; flex-shrink: 0; transition: all 0.3s; }
        .bucket-text { font-size: 17px; flex-grow: 1; color: #555; transition: color 0.3s; }
        .del-btn { border: none; background: none; color: #ffcccc; cursor: pointer; font-size: 20px; padding: 0 10px; }
        .del-btn:hover { color: #ff6b6b; transform: scale(1.2); }
        .bucket-item.done { background: linear-gradient(to right, #fdfbfb, #ebedee); }
        .bucket-item.done .check-icon { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); border: none; color: white; }
        .bucket-item.done .bucket-text { color: #aaa; text-decoration: line-through; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="home-btn">ğŸ </a>
            <h1>ìš°ë¦¬ì˜ ë²„í‚·ë¦¬ìŠ¤íŠ¸ âœ¨</h1>
            <p>í„°ì¹˜í•˜ë©´ ì™„ë£Œë©ë‹ˆë‹¤!</p>
        </div>
        <div class="progress-container"><div class="progress-bar" id="progressBar">0%</div></div>
        <ul class="bucket-list" id="bucketUl"><div style="text-align:center; margin-top:30px;">ë¡œë”© ì¤‘...</div></ul>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, orderBy, onSnapshot, updateDoc, doc, deleteDoc } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyANq4I8DZbehfYXy8vhfvEGOuES2sIIM88",
  authDomain: "yj-sc-memory.firebaseapp.com",
  projectId: "yj-sc-memory",
  storageBucket: "yj-sc-memory.firebasestorage.app",
  messagingSenderId: "827467276790",
  appId: "1:827467276790:web:d747825d06c334614fe7d7",
  measurementId: "G-YYCFN18XRL"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        const q = query(collection(db, "bucketlist"), orderBy("date", "asc"));

        onSnapshot(q, (snapshot) => {
            const bucketUl = document.getElementById('bucketUl');
            bucketUl.innerHTML = "";
            let total = 0, doneCount = 0;

            if(snapshot.empty) bucketUl.innerHTML = `<div style="text-align:center; color:#999; margin-top:30px;">ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ì¶”ê°€í•˜ì„¸ìš”!</div>`;

            snapshot.forEach((docSnap) => {
                total++;
                const item = docSnap.data();
                if(item.done) doneCount++;

                const li = document.createElement('li');
                li.className = 'bucket-item' + (item.done ? ' done' : '');
                li.innerHTML = `
                    <div class="check-icon">âœ”</div>
                    <div class="bucket-text">${item.text}</div>
                    <button class="del-btn">Ã—</button>
                `;
                li.onclick = async (e) => {
                    if(e.target.classList.contains('del-btn')) return;
                    await updateDoc(doc(db, "bucketlist", docSnap.id), { done: !item.done });
                };
                li.querySelector('.del-btn').onclick = async () => {
                    if(confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) await deleteDoc(doc(db, "bucketlist", docSnap.id));
                };
                bucketUl.appendChild(li);
            });

            if (total > 0) {
                const percent = Math.round((doneCount / total) * 100);
                setTimeout(() => { 
                    document.getElementById('progressBar').style.width = percent + "%"; 
                    document.getElementById('progressBar').innerText = percent + "% ë‹¬ì„±!";
                }, 100);
            }
        });
    </script>
</body>
</html>